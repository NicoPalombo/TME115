# First of all, it's necessary to install the packages that will be necessary for the development of this project. 
```{r}
library(tidyverse)
library(tidyquant)
library(ggplot2)
library(quantmod)
library(TTR)
library(PerformanceAnalytics)
library(dplyr)
library(lubridate)
library(magrittr)
library(scales)
btc <- read.csv("C:/Users/neard/Downloads/bitcoin(2013-2025).csv") # The actual path will be changed in the future to be possible to be reproduced on other platforms, and the file will be changed in 06-01-2025
```


#Conversor
```{r}
conversor <- function(unix_column){
as.POSIXct(unix_column, origin = "1970-01-01", tz = "UTC")
}
btc$Timestamp <- conversor(btc$Timestamp)
```

#Checking for possible convertion errors:
```{r}
erros <- which(is.na(btc$Timestamp)
```


#Grouping by month
```{r}
btc_m <- btc %>%
  mutate(
  date = as.Date(Timestamp),
  month = floor_date(date,"month")
) %>%
group_by(month) %>%
summarise(
  Open = first(Open),
  High = max(High),
  Low = min(Low),
  Close = last(Close),
  Volume = sum(Volume)
)
```

#Candlestick grouping by month
```{r}
ggplot(btc_m, aes(x = month)) +
  geom_linearange(aes(ymin = Low, ymax = High), color = "black", linewidth = 0) +
  geom_rect(
  aes(
      xmin = month - 20
      xmax = month + 20
      ymin = pmin(Open, Close),
      ymax = pmax(Open, Close),
      fill = ifelse(Close >= Open, "green", "red")
),
  color = "white"
) +
scale_y_continuous(labels = dollar_format()) +
labs(title = "Candlestick Mensal do Bitcoin", x = "Mês", y = "Preço (USD)") +
theme_minimal()
```




